var c=Object.assign;var m=(u,e,t)=>new Promise((r,n)=>{var a=o=>{try{s(t.next(o))}catch(d){n(d)}},y=o=>{try{s(t.throw(o))}catch(d){n(d)}},s=o=>o.done?r(o.value):Promise.resolve(o.value).then(a,y);s((t=t.apply(u,e)).next())});import{getLocalStorage as i,setLocalStorage as l,renderListWithTemplate as h}from"./utils.js";export default class p{constructor(e){this.cartList=[],this.listElement=e,this.cartTotalValue=0}init(e,t){return m(this,null,function*(){this.cartList=yield this.getCartContent(),this.cartTotalValue=this.cartTotal(t),this.renderCartItems(this.cartList,e,this.listElement)})}getCartContent(){const e=i("so-cart");return e==null?[]:e}cartTotal(e){if(this.cartList.length===0)return e.innerText=e.innerText+" $0",0;e.innerText=e.innerText+` $${Math.round(this.cartList.reduce((t,r)=>t+r.ListPrice*r.quantity,0)*100)/100}`}prepareTemplate(e,t){const r=e,n=r.querySelector(".prod-img");n.src=t.Images.PrimaryMedium,t.alt=t.Name;const a=r.querySelector(".card__name");a.innerHTML=t.Name,r.querySelector(".material-symbols-outlined").setAttribute("data-id",t.Id);const s=r.querySelector(".cart-card__color");s.innerHTML=t.Colors[0].ColorName;const o=r.querySelector(".qt-num");o.innerHTML=t.quantity,r.querySelector(".cart-card__addQuantity").setAttribute("data-id",t.Id),r.querySelector(".cart-card__removeQuantity").setAttribute("data-id",t.Id);const I=r.querySelector(".cart-card__price");return I.innerHTML=`$${t.FinalPrice}`,r}renderCartItems(e,t,r){const n=document.querySelector(t);let a;h(n,r,e,a,this.prepareTemplate)}removeItem(e){e.preventDefault();const t=e.target.dataset.id;if(i("so-cart")!==null){const n=i("so-cart").filter(a=>a.Id!==t);l("so-cart",n),window.location.reload()}}addQuantity(e){const t=e.target.dataset.id,n=i("so-cart").map(a=>a.Id===t?c(c({},a),{quantity:a.quantity+1}):a);l("so-cart",n),window.location.reload()}removeQuantity(e){const t=e.target.dataset.id,n=i("so-cart").map(a=>a.Id===t?c(c({},a),{quantity:a.quantity-1}):a);l("so-cart",n),window.location.reload()}}
